<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Implement HTTPS using SSL/TLS for FREE within 5 minutes</title>
    <meta name="description" content="A description that will appear as a default if front matter does not exist" />
    <meta name="keywords" content='guide,web,sysadmin,nginx,ssl,https,letsencrypt' />
    
    
    <link href="" rel="alternate" type="application/rss+xml" title="Computable(verse)" />
    <link href="https://fonts.googleapis.com/css?family=Merriweather" rel="stylesheet">
    <link rel="stylesheet" href="http://computableverse.com/css/normalize.css" />
    <link rel="stylesheet" href="http://computableverse.com/css/sakura.css" />
    <link rel="stylesheet" href="http://computableverse.com/css/custom.css" />
    <meta property="og:title" content="Implement HTTPS using SSL/TLS for FREE within 5 minutes" />
<meta property="og:description" content="I reckon I&rsquo;ll need to set up TLS for several sites in the future. Applying the DRY principle, I&rsquo;m documenting the steps while it&rsquo;s fresh in my head, so that I don&rsquo;t have to waste time 10 months down the line.

So let&rsquo;s keep this short and useful.

" />
<meta property="og:type" content="article" />
<meta property="og:url" content="http://computableverse.com/blog/implement-https-using-ssl-tls-free-fast/" />


<meta property="og:updated_time" content="2016-06-12T00:00:00&#43;00:00"/>









<meta property="fb:admins" content="100000855963383" />
    
    
<meta itemprop="name" content="Implement HTTPS using SSL/TLS for FREE within 5 minutes">
<meta itemprop="description" content="I reckon I&rsquo;ll need to set up TLS for several sites in the future. Applying the DRY principle, I&rsquo;m documenting the steps while it&rsquo;s fresh in my head, so that I don&rsquo;t have to waste time 10 months down the line.

So let&rsquo;s keep this short and useful.

">


<meta itemprop="dateModified" content="2016-06-12T00:00:00&#43;00:00" />
<meta itemprop="wordCount" content="413">



<meta itemprop="keywords" content="ajax,atom,autocomplete,cors,django,dotfiles,fix,flask,git,guide,https,install,letsencrypt,linux,macos,markdown,neovim,nginx,pandoc,publishing,pypi,python,setup,ssl,stagit,static-site-generators,sysadmin,terminal,testing,text-editors,thoughts,til,ubuntu,vim,web,workflow,zsh," />

    

  <meta name="twitter:card" content="summary"/>



<meta name="twitter:title" content="Implement HTTPS using SSL/TLS for FREE within 5 minutes"/>
<meta name="twitter:description" content="I reckon I&rsquo;ll need to set up TLS for several sites in the future. Applying the DRY principle, I&rsquo;m documenting the steps while it&rsquo;s fresh in my head, so that I don&rsquo;t have to waste time 10 months down the line.

So let&rsquo;s keep this short and useful.

"/>
<meta name="twitter:site" content="@oxalorg"/>
<meta name="twitter:domain" content="computableverse.com"/>

</head>
<body>
    <header class="site-header">
        <h1 class="site-title"> <a href="/">computable<span class="meta">(</span><em>verse</em><span class="meta">)</span></a> {</h1>
        <p class="meta">/* <a href="/about/">about</a> | <a href="/blog/">archive</a> */
        </p>
    </header>
    <section class="site-main">
        <section class="content">
            
<article class="post">
<h1 class="post-title">Implement HTTPS using SSL/TLS for FREE within 5 minutes</h1>
<p class="meta"> 

<small>
    Posted on <time datetime="2016-06-12T00:00:00Z">June 12, 2016</time>
    by <a href="http://miteshshah.com">Mitesh Shah</a>
    
        
        in <span><a href="http://computableverse.com/tags/guide">guide</a>, <a href="http://computableverse.com/tags/web">web</a>, <a href="http://computableverse.com/tags/sysadmin">sysadmin</a>, <a href="http://computableverse.com/tags/nginx">nginx</a>, <a href="http://computableverse.com/tags/ssl">ssl</a>, <a href="http://computableverse.com/tags/https">https</a>, <a href="http://computableverse.com/tags/letsencrypt">letsencrypt</a></span>
    
</small>
 </p>

<p>I reckon I&rsquo;ll need to set up TLS for several sites in the future. Applying the DRY principle, I&rsquo;m documenting the steps while it&rsquo;s fresh in my head, so that I don&rsquo;t have to waste time 10 months down the line.</p>

<p>So let&rsquo;s keep this short and useful.</p>

<p></p>

<h3 id="install-letsencrypt">Install letsencrypt</h3>

<p>No wizardry here. Simple as sh. Refer this <a href="https://www.nginx.com/blog/free-certificates-lets-encrypt-and-nginx/">guide</a> for more details.</p>
sudo git clone https://github.com/letsencrypt/letsencrypt /opt/letsencrypt
cd /opt/letsencrypt
sudo ./letsencrypt-auto
cd /var/www
mkdir letsencrypt
sudo chgrp www-data letsencrypt

<h3 id="set-up-letsencrypt-config-file-and-fetch-certificates">Set up letsencrypt config file and fetch certificates</h3>

<p>More info <a href="https://gist.github.com/xrstf/581981008b6be0d2224f">here</a>, but siriusly no need to get too involved. Just run the below script as follows <code>sh setupLEConfig.sh &lt;your-domain-name-here&gt; &lt;your-email-here&gt;</code>:</p>
#!/bin/bash

cat <<EOF > /etc/letsencrypt/configs/$1.conf
domains = $1
rsa-key-size = 4096

# the current closed beta (as of 2015-Nov-07) is using this server
server = https://acme-v01.api.letsencrypt.org/directory

# this address will receive renewal reminders
email = $2

# turn off the ncurses UI, we want this to be run as a cronjob
text = True

# authenticate by placing a file in the webroot (under .well-known/acme-challenge/)
# and then letting LE fetch it
authenticator = webroot
webroot-path = /var/www/letsencrypt/
EOF

<h3 id="fetch-certifcates-and-verify">Fetch certifcates and verify</h3>

<p>Point CA (certificate authority) where to find temporary files used for authenticating that you own the domain.</p>
server {
    listen 80;
    server_name mitesh.ninja;

    # This block is important
    location /.well-known/acme-challenge {
        root /var/www/letsencrypt;
    }
}

<p>Now restart nginx</p>

<pre><code>sudo nginx -t &amp;&amp; sudo nginx -s reload
</code></pre>

<p>and actually fetch the certs:</p>
cd /opt/letsencrypt
./letsencrypt-auto --config /etc/letsencrypt/configs/mitesh.ninja.conf certonly

<h3 id="final-nginx-config-for-https">Final nginx config for https</h3>

<ol>
<li>Listen on port 443 (for ssl).<br /></li>
<li>Tell nginx where to find your certificates.<br /></li>
<li>Tell CA (certificate authority) where to find temporary files used for authenticating that you own the domain.<br />

<ul>
<li>We did this in http server block for first time authentication.<br /></li>
<li>https server block for authentication henceforth.<br /></li>
</ul></li>
<li>Rewrite http traffic to https.<br /></li>
</ol>
server {
    ###
    # Replace 'mitesh.ninja' with your own FQDN.
    ##
    listen 443 ssl; # Step 1
    server_name mitesh.ninja;

    # Step 2
    ssl_certificate /etc/letsencrypt/live/mitesh.ninja/fullchain.pem;
    ssl_certificate_key /etc/letsencrypt/live/mitesh.ninja/privkey.pem;

    # Step 3
    location /.well-known/acme-challenge {
        root /var/www/letsencrypt;
    }
}
server {
    listen 80;
    server_name mitesh.ninja www.mitesh.ninja;
    return 301 https://$host$request_uri;
}

<p>Now restart nginx</p>

<pre><code>sudo nginx -t &amp;&amp; sudo nginx -s reload
</code></pre>

<p><strong>VOILA!</strong> That&rsquo;s it. https live at <a href="https://mitesh.ninja">https://mitesh.ninja</a>. View full nginx conf <a href="https://github.com/MiteshNinja/mitesh.ninja/blob/master/conf/mitesh.ninja.conf">here</a> :D)</p>

<p>Note: The certificates will expire every 3 months. I haven&rsquo;t set up a cron job atm. I&rsquo;m researching more about it, trying new stuff and will most likely roll up a small python script to handle auto renewing.</p>
</article>
<div id="disqus_thread"></div>
<script type="text/javascript">
    var disqus_shortname = 'computableverse';
    var disqus_identifier = 'http:\/\/computableverse.com\/blog\/implement-https-using-ssl-tls-free-fast\/';
    var disqus_title = 'Implement HTTPS using SSL\/TLS for FREE within 5 minutes';
    var disqus_url = 'http:\/\/computableverse.com\/blog\/implement-https-using-ssl-tls-free-fast\/';

    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>

        </section>
    </section>
    <footer class="site-footer">
        <h1>}</h1> 
    </footer>
    
<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-61533153-1', 'auto');
ga('send', 'pageview');
</script>

</body>
</html>
